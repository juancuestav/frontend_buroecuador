import{b as j,Q as B}from"./QItem.287f8ef9.js";import{_ as T,d as D,a3 as F,aa as G,r as p,V as q,K as P,X as w,P as a,M as t,j as s,N as U,a5 as c,Q as f,U as E}from"./index.aea1effc.js";import{Q as z}from"./QSelect.2477ae10.js";import{Q as K}from"./QPage.161283b6.js";import{P as X,a as Q,c as H}from"./Permiso.41ecb692.js";import{a as J}from"./notificaciones.305263b9.js";import{E as W}from"./EssentialTable.a2272a35.js";import{M as Y,C as Z}from"./ComportamientoModalesPermisoNuevo.05dba95f.js";import{C as h}from"./ContenedorSimpleMixin.9e6b94a2.js";import{T as x}from"./TransacccionSimpleController.d6ace83b.js";import{R as oo}from"./RolController.4a5cdc75.js";import{_ as eo}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.f8291af0.js";import"./QMenu.ef20bc9f.js";import"./position-engine.c19cb930.js";import"./selection.a0a4309d.js";import"./format.8ac60962.js";import"./entidadAuditable.9f5621ba.js";import"./Hidratable.166e9fe1.js";import"./QTooltip.d74f897f.js";import"./QBadge.66caf36c.js";import"./utils.27a4761f.js";import"./date.0b7cec79.js";import"./QToolbarTitle.2f0d394a.js";import"./logo.d1d9b491.js";import"./_commonjsHelpers.80d8c10d.js";import"./EstadosComponent.4d132387.js";import"./utils.508c826c.js";import"./QForm.5ecf612c.js";import"./i18n-validators.b664e07d.js";import"./index.cab36ed2.js";import"./vue-i18n.runtime.23737610.js";import"./index.9737fa5c.js";import"./TabLayout.7cfb4972.js";import"./QTabs.18a819ba.js";import"./QResizeObserver.5837b731.js";import"./QTabPanels.10a35ad8.js";import"./touch.9135741d.js";import"./use-render-cache.3aae9b27.js";import"./buttonSubmits.08b9f7f5.js";class ro extends x{constructor(){super(T.asignar_permisos)}}var so=D({components:{EssentialTable:W,ModalEntidad:Y},setup(){J().setQuasar(F());const o=new h(X,new Q),{entidad:e,listadosAuxiliares:l,listado:R}=o.useReferencias(),{cargarVista:S,obtenerListados:A,listar:u}=o.useComportamiento();S(async()=>{await A({roles:{controller:new oo,params:{campos:"id,name"}}})});const g=G(),r=p(),d=p([]),V=new Q,N=new ro,y=p([]),b=p(),v=p(),k=new Z;d.value=l.roles;async function C(i){i&&(u({rol_id:i,tipo:"ASIGNADOS",tipo_filtro:"POR ROL"}),y.value=(await V.listar({rol_id:i,tipo:"NO ASIGNADOS",tipo_filtro:"POR ROL"})).result)}async function _(){await b.value.seleccionar(),await b.value.clearSelection()}async function I(){await v.value.seleccionar(),await v.value.clearSelection()}async function O(i){const n=i.map(m=>m.id);await N.guardar({id_rol:r.value,permisos:n,tipo_sincronizacion:"ASIGNAR"}),await C(r.value)}function $(i){const n=i.map(m=>m.id);N.guardar({id_rol:r.value,permisos:n,tipo_sincronizacion:"ELIMINAR"}),C(r.value)}function M(){k.abrirModalEntidad("PermisoNuevoPage")}return{mixin:o,permiso:e,modales:k,configuracionColumnasPermisos:H,rol:r,listado:R,permisosSinAsignar:y,crearRol:()=>{g.replace("/roles")},crear_permiso:M,obtenerPermisoRol:C,asignarPermiso:O,eliminarPermiso:$,botonAsignarPermisos:_,botonEliminarPermisos:I,listadosAuxiliares:l,roles:d,refPermisosSinAsignar:b,refPermisosAsignados:v,filtrarRol(i,n){if(i===""){n(()=>{d.value=l.roles});return}n(()=>{const m=i.toLowerCase();d.value=l.roles.filter(L=>L.nombre.toLowerCase().indexOf(m)>-1)})}}}});const io={class:"text-h6 q-mb-md"},ao={class:"row q-col-gutter-sm q-mb-md q-mt-xs"},to={class:"col-12 col-md-5 q-gutter-y-sm"},no={class:"col-md-2 column justify-center q-gutter-y-sm"},lo={class:"col-12 col-md-5 q-mb-md"};function mo(o,e,l,R,S,A){const u=q("essential-table"),g=q("modal-entidad");return P(),w(K,{padding:"",class:"q-pa-lg"},{default:a(()=>[t("div",io,[e[6]||(e[6]=t("label",{class:"q-mb-sm block"},"Roles",-1)),s(z,{modelValue:o.rol,"onUpdate:modelValue":[e[1]||(e[1]=r=>o.rol=r),o.obtenerPermisoRol],options:o.roles,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"","error-message":"Debes seleccionar un rol","use-input":"","input-debounce":"0",onFilter:o.filtrarRol,"option-value":r=>r.id,"option-label":r=>r.name,"emit-value":"","map-options":""},{"no-option":a(()=>[s(j,null,{default:a(()=>[s(B,{class:"text-grey"},{default:a(()=>e[5]||(e[5]=[U(" No hay resultados ")])),_:1})]),_:1})]),after:a(()=>[s(c,{class:"block",color:"secondary",onClick:e[0]||(e[0]=r=>o.crearRol())},{default:a(()=>[s(f,{name:"bi-plus"})]),_:1})]),_:1},8,["modelValue","options","onUpdate:modelValue","onFilter","option-value","option-label"])]),t("div",ao,[t("div",to,[e[7]||(e[7]=t("div",null,"No Asignados",-1)),s(u,{configuracionColumnas:o.configuracionColumnasPermisos,datos:o.permisosSinAsignar,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,mostrarFooter:!0,mostrarColumnasVisibles:!1,mostrarExportar:!0,ref:"refPermisosSinAsignar",onSelected:o.asignarPermiso,"tipo-seleccion":"multiple"},null,8,["configuracionColumnas","datos","onSelected"])]),t("div",no,[s(c,{class:"full-width block",color:"positive",onClick:e[2]||(e[2]=r=>o.crear_permiso()),unelevated:"",square:""},{default:a(()=>[s(f,{name:"bi-plus"})]),_:1}),o.rol!==void 0?(P(),w(c,{key:0,class:"full-width block",color:"primary",onClick:e[3]||(e[3]=r=>o.botonAsignarPermisos()),unelevated:"",square:""},{default:a(()=>[s(f,{name:"bi-arrow-right"})]),_:1})):E("",!0),o.rol!==void 0?(P(),w(c,{key:1,class:"full-width block",color:"negative",onClick:e[4]||(e[4]=r=>o.botonEliminarPermisos()),unelevated:"",square:""},{default:a(()=>[s(f,{name:"bi-arrow-left"})]),_:1})):E("",!0)]),t("div",lo,[e[8]||(e[8]=t("div",{class:"q-mb-sm"},"Asignados",-1)),s(u,{configuracionColumnas:o.configuracionColumnasPermisos,mostrarColumnasVisibles:!1,datos:o.listado,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,mostrarExportar:!0,ref:"refPermisosAsignados",onSelected:o.eliminarPermiso,"tipo-seleccion":"multiple"},null,8,["configuracionColumnas","datos","onSelected"])])]),s(g,{comportamiento:o.modales},null,8,["comportamiento"])]),_:1})}var ho=eo(so,[["render",mo]]);export{ho as default};
