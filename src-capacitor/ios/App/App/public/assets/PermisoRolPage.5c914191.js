import{b as j,Q as B}from"./QItem.159d8e83.js";import{Z as T,d as D,a7 as F,r as p,U as q,J as P,V as w,O as a,L as t,j as s,M as G,a2 as c,Q as f,S as E}from"./index.6072a1b1.js";import{Q as U}from"./QSelect.8fa0bc61.js";import{Q as z}from"./QPage.2411b3e2.js";import{P as J,a as Q,c as Z}from"./Permiso.694b0925.js";import{a as H}from"./notificaciones.fe24470b.js";import{u as K}from"./use-quasar.52f58024.js";import{E as W}from"./EssentialTable.0effb8dc.js";import{M as X,C as Y}from"./ComportamientoModalesPermisoNuevo.86f7aa86.js";import{C as h}from"./ContenedorSimpleMixin.6f374d2f.js";import{T as x}from"./TransacccionSimpleController.f4dc3690.js";import{R as oo}from"./RolController.531a0f0a.js";import{_ as eo}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.2863bbd0.js";import"./QMenu.6c964ac0.js";import"./position-engine.71479b28.js";import"./selection.ec88bd7c.js";import"./format.8ac60962.js";import"./entidadAuditable.9f5621ba.js";import"./Hidratable.166e9fe1.js";import"./QTooltip.0b1018fa.js";import"./QBadge.1ab9ad97.js";import"./utils.c7760b0c.js";import"./date.3330acff.js";import"./QToolbarTitle.80dd577d.js";import"./logo.d1d9b491.js";import"./_commonjsHelpers.8402d862.js";import"./EstadosComponent.69881137.js";import"./utils.508c826c.js";import"./QForm.7a1734b3.js";import"./i18n-validators.254d0ba5.js";import"./index.d3fb51b6.js";import"./vue-i18n.runtime.0ca83697.js";import"./index.1be77ee8.js";import"./TabLayout.6a412dfb.js";import"./QTabs.4b078992.js";import"./QResizeObserver.cd2c994f.js";import"./QTabPanels.2a304c71.js";import"./touch.9135741d.js";import"./use-render-cache.3aae9b27.js";import"./buttonSubmits.178f5d81.js";import"./StatusEssentialLoading.d6258813.js";class ro extends x{constructor(){super(T.asignar_permisos)}}var so=D({components:{EssentialTable:W,ModalEntidad:X},setup(){H().setQuasar(K());const o=new h(J,new Q),{entidad:e,listadosAuxiliares:l,listado:S}=o.useReferencias(),{cargarVista:R,obtenerListados:A,listar:u}=o.useComportamiento();R(async()=>{await A({roles:{controller:new oo,params:{campos:"id,name"}}})});const g=F(),r=p(),d=p([]),V=new Q,N=new ro,y=p([]),b=p(),v=p(),k=new Y;d.value=l.roles;async function C(i){i&&(u({rol_id:i,tipo:"ASIGNADOS",tipo_filtro:"POR ROL"}),y.value=(await V.listar({rol_id:i,tipo:"NO ASIGNADOS",tipo_filtro:"POR ROL"})).result)}async function O(){await b.value.seleccionar(),await b.value.clearSelection()}async function I(){await v.value.seleccionar(),await v.value.clearSelection()}async function _(i){const n=i.map(m=>m.id);await N.guardar({id_rol:r.value,permisos:n,tipo_sincronizacion:"ASIGNAR"}),await C(r.value)}function $(i){const n=i.map(m=>m.id);N.guardar({id_rol:r.value,permisos:n,tipo_sincronizacion:"ELIMINAR"}),C(r.value)}function L(){k.abrirModalEntidad("PermisoNuevoPage")}return{mixin:o,permiso:e,modales:k,configuracionColumnasPermisos:Z,rol:r,listado:S,permisosSinAsignar:y,crearRol:()=>{g.replace("/roles")},crear_permiso:L,obtenerPermisoRol:C,asignarPermiso:_,eliminarPermiso:$,botonAsignarPermisos:O,botonEliminarPermisos:I,listadosAuxiliares:l,roles:d,refPermisosSinAsignar:b,refPermisosAsignados:v,filtrarRol(i,n){if(i===""){n(()=>{d.value=l.roles});return}n(()=>{const m=i.toLowerCase();d.value=l.roles.filter(M=>M.nombre.toLowerCase().indexOf(m)>-1)})}}}});const io={class:"text-h6 q-mb-md"},ao={class:"row q-col-gutter-sm q-mb-md q-mt-xs"},to={class:"col-12 col-md-5 q-gutter-y-sm"},no={class:"col-md-2 column justify-center q-gutter-y-sm"},lo={class:"col-12 col-md-5 q-mb-md"};function mo(o,e,l,S,R,A){const u=q("essential-table"),g=q("modal-entidad");return P(),w(z,{padding:"",class:"q-pa-lg"},{default:a(()=>[t("div",io,[e[6]||(e[6]=t("label",{class:"q-mb-sm block"},"Roles",-1)),s(U,{modelValue:o.rol,"onUpdate:modelValue":[e[1]||(e[1]=r=>o.rol=r),o.obtenerPermisoRol],options:o.roles,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"","error-message":"Debes seleccionar un rol","use-input":"","input-debounce":"0",onFilter:o.filtrarRol,"option-value":r=>r.id,"option-label":r=>r.name,"emit-value":"","map-options":""},{"no-option":a(()=>[s(j,null,{default:a(()=>[s(B,{class:"text-grey"},{default:a(()=>e[5]||(e[5]=[G(" No hay resultados ")])),_:1})]),_:1})]),after:a(()=>[s(c,{class:"block",color:"secondary",onClick:e[0]||(e[0]=r=>o.crearRol())},{default:a(()=>[s(f,{name:"bi-plus"})]),_:1})]),_:1},8,["modelValue","options","onUpdate:modelValue","onFilter","option-value","option-label"])]),t("div",ao,[t("div",to,[e[7]||(e[7]=t("div",null,"No Asignados",-1)),s(u,{configuracionColumnas:o.configuracionColumnasPermisos,datos:o.permisosSinAsignar,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,mostrarFooter:!0,mostrarColumnasVisibles:!1,mostrarExportar:!0,ref:"refPermisosSinAsignar",onSelected:o.asignarPermiso,"tipo-seleccion":"multiple"},null,8,["configuracionColumnas","datos","onSelected"])]),t("div",no,[s(c,{class:"full-width block",color:"positive",onClick:e[2]||(e[2]=r=>o.crear_permiso()),unelevated:"",square:""},{default:a(()=>[s(f,{name:"bi-plus"})]),_:1}),o.rol!==void 0?(P(),w(c,{key:0,class:"full-width block",color:"primary",onClick:e[3]||(e[3]=r=>o.botonAsignarPermisos()),unelevated:"",square:""},{default:a(()=>[s(f,{name:"bi-arrow-right"})]),_:1})):E("",!0),o.rol!==void 0?(P(),w(c,{key:1,class:"full-width block",color:"negative",onClick:e[4]||(e[4]=r=>o.botonEliminarPermisos()),unelevated:"",square:""},{default:a(()=>[s(f,{name:"bi-arrow-left"})]),_:1})):E("",!0)]),t("div",lo,[e[8]||(e[8]=t("div",{class:"q-mb-sm"},"Asignados",-1)),s(u,{configuracionColumnas:o.configuracionColumnasPermisos,mostrarColumnasVisibles:!1,datos:o.listado,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,mostrarExportar:!0,ref:"refPermisosAsignados",onSelected:o.eliminarPermiso,"tipo-seleccion":"multiple"},null,8,["configuracionColumnas","datos","onSelected"])])]),s(g,{comportamiento:o.modales},null,8,["comportamiento"])]),_:1})}var oe=eo(so,[["render",mo]]);export{oe as default};
